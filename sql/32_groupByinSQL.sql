 /*** GROUP BY IN SQL **/
 
 CREATE TABLE #TEST (CITYID INT,STUDENTID INT,MARK1 INT,MARK2 INT,MARK3 INT,MARK4 INT,MARK5 INT,TOTAL INT)

	INSERT INTO #TEST
	SELECT 1,1,67,65,68,65,69,334 UNION ALL
	SELECT 1,2,68,66,69,66,70,339 UNION ALL
	SELECT 1,3,67,65,68,65,69,334 UNION ALL
	SELECT 2,4,70,68,71,68,72,349 UNION ALL
	SELECT 2,5,71,69,72,69,73,354 UNION ALL
	SELECT 2,6,72,70,73,70,74,359 UNION ALL
	SELECT 3,7,73,71,74,71,75,364 UNION ALL
	SELECT 3,8,74,72,75,72,76,369 UNION ALL
	SELECT 3,9,72,70,73,70,74,359 UNION ALL
	SELECT 4,10,76,74,77,74,78,379 UNION ALL
	SELECT 4,11,77,75,78,75,79,384 UNION ALL
	SELECT 4,12,72,70,73,70,74,359 UNION ALL
	SELECT 5,13,79,77,80,77,81,394 
	
	SELECT CITYID,AVG(TOTAL) AS AVG_CITY FROM #TEST
	GROUP BY CITYID
	
	SELECT CITYID,MAX(TOTAL) AS MAX_CITY FROM #TEST
	GROUP BY CITYID
	
	SELECT CITYID,MIN(TOTAL) AS MIN_CITY FROM #TEST
	GROUP BY CITYID
	
	SELECT CITYID , COUNT(STUDENTID) COUNT_CITY  FROM #TEST
	GROUP BY CITYID
	
	SELECT CITYID , SUM(TOTAL) AS SUM_TOT FROM #TEST
	GROUP BY CITYID
	
	CREATE TABLE #TEST_1 (CITYID INT,STUDENTID INT,MARK1 INT,MARK2 INT,MARK3 INT,MARK4 INT,MARK5 INT,TOTAL INT)

	INSERT INTO #TEST_1
	SELECT 1,1,67,65,68,65,69,334 UNION ALL
	SELECT 1,2,68,66,69,66,70,339 UNION ALL
	SELECT 1,2,68,66,69,66,70,339 UNION ALL
	SELECT 1,3,67,65,68,65,69,334 UNION ALL
	SELECT 2,4,70,68,71,68,72,349 UNION ALL
	SELECT 2,5,71,69,72,69,73,354 UNION ALL
	SELECT 2,6,72,70,73,70,74,359 UNION ALL
	SELECT 3,7,73,71,74,71,75,364 UNION ALL
	SELECT 3,8,74,72,75,72,76,369 UNION ALL
	SELECT 3,9,72,70,73,70,74,359 UNION ALL
	SELECT 4,10,76,74,77,74,78,379 UNION ALL
	SELECT 4,11,77,75,78,75,79,384 UNION ALL
	SELECT 4,12,72,70,73,70,74,359 UNION ALL
	SELECT 5,13,79,77,80,77,81,394 
	
	
	SELECT * FROM #TEST_1
	
	SELECT CITYID,COUNT(STUDENTID)  FROM #TEST_1
	GROUP BY CITYID
	
	SELECT CITYID,COUNT(DISTINCT STUDENTID)  FROM #TEST_1
	GROUP BY CITYID
	

